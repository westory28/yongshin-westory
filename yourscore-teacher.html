<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>í‰ê°€ ê¸°ì¤€ ê´€ë¦¬ì (ì„ ìƒë‹˜ìš©)</title>
</head>
<body>
    <h2>ğŸ“ í‰ê°€ ê¸°ì¤€ ë“±ë¡</h2>
    <input type="text" id="subjectName" placeholder="ê³¼ëª©ëª… (ì˜ˆ: í•œêµ­ì‚¬)" />
    <div id="criteriaList">
        <div class="criteria-row">
            <input type="text" placeholder="í•­ëª©ëª… (ì˜ˆ: ì¤‘ê°„ê³ ì‚¬)" class="c-name">
            <input type="number" placeholder="ë§Œì " class="c-max">
            <input type="number" placeholder="ë°˜ì˜ë¹„ìœ¨(%)" class="c-ratio">
        </div>
    </div>
    <button onclick="addRow()">+ í•­ëª© ì¶”ê°€</button>
    <button onclick="saveToFirebase()">ğŸ’¾ ê¸°ì¤€ ì €ì¥í•˜ê¸°</button>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

        // ê¸°ì¡´ íŒŒì´ì–´ë² ì´ìŠ¤ ì„¤ì •ê°’ ë¶™ì—¬ë„£ê¸°
        const firebaseConfig = {
  apiKey: "AIzaSyAOlPQ5PFmL0zxmGrGcuEBnqBXisph7kPU",
  authDomain: "history-quiz-yongsin.firebaseapp.com",
  projectId: "history-quiz-yongsin",
  storageBucket: "history-quiz-yongsin.firebasestorage.app",
  messagingSenderId: "177587430482",
  appId: "1:177587430482:web:1188e0f661368040c3ab8b",
  measurementId: "G-YG2SLS45D8"
};
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // í–‰ ì¶”ê°€ ë¡œì§
        window.addRow = () => {
            const div = document.createElement('div');
            div.className = 'criteria-row';
            div.innerHTML = `
                <input type="text" placeholder="í•­ëª©ëª…" class="c-name">
                <input type="number" placeholder="ë§Œì " class="c-max">
                <input type="number" placeholder="ë°˜ì˜ë¹„ìœ¨(%)" class="c-ratio">
            `;
            document.getElementById('criteriaList').appendChild(div);
        };

        // ì €ì¥ ë¡œì§
        window.saveToFirebase = async () => {
            const subject = document.getElementById('subjectName').value;
            const rows = document.querySelectorAll('.criteria-row');
            const items = [];

            rows.forEach(row => {
                items.push({
                    name: row.querySelector('.c-name').value,
                    maxScore: Number(row.querySelector('.c-max').value),
                    ratio: Number(row.querySelector('.c-ratio').value)
                });
            });

            try {
                await addDoc(collection(db, "grading_plans"), {
                    subject: subject,
                    items: items,
                    createdAt: new Date()
                });
                alert("ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤! í•™ìƒ í˜ì´ì§€ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
            } catch (e) {
                console.error("Error: ", e);
                alert("ì €ì¥ ì‹¤íŒ¨");
            }
        };
    </script>
</body>
</html>
