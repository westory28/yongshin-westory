<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>êµì‚¬ ëŒ€ì‹œë³´ë“œ - ì‹œí—˜ ì •ë‹µ ê´€ë¦¬</title>
    <style>
        /* [ê¸°ì¡´ ìŠ¤íƒ€ì¼ ê³„ìŠ¹] */
        body { font-family: 'Noto Sans KR', sans-serif; background-color: #f0f2f5; margin: 0; padding: 0; color: #333; }
        a { text-decoration: none; color: inherit; }
        * { box-sizing: border-box; }

        /* í—¤ë” ìŠ¤íƒ€ì¼ */
        header { background-color: white; border-bottom: 1px solid #e5e7eb; position: sticky; top: 0; z-index: 50; }
        .header-container { max-width: 80rem; margin: 0 auto; padding: 0 1.5rem; height: 64px; display: flex; align-items: center; justify-content: space-between; }
        .logo-text { font-size: 1.5rem; font-weight: 800; letter-spacing: -0.025em; cursor: pointer; display: flex; align-items: center; }
        .logo-we { color: #2563eb; }
        .logo-story { color: #f59e0b; }

        .nav-container { display: flex; height: 100%; }
        .nav-link { font-weight: 500; color: #6b7280; margin: 0 1rem; text-decoration: none; font-size: 0.95rem; height: 100%; display: inline-flex; align-items: center; border-bottom: 3px solid transparent; transition: all 0.2s; }
        .nav-link:hover { color: #111827; }
        .nav-link.active { color: #2563eb; border-bottom-color: #2563eb; font-weight: 700; }

        .right-actions { display: flex; align-items: center; gap: 10px; }
        .btn-logout-custom { color: #78716c; font-size: 0.875rem; font-weight: 700; padding: 0.5rem 0.75rem; border-radius: 0.25rem; background-color: transparent; border: none; cursor: pointer; transition: all 0.2s; white-space: nowrap; }
        .btn-logout-custom:hover { color: #292524; background-color: #f5f5f4; }
        .hamburger-btn { display: none; background: none; border: none; font-size: 24px; cursor: pointer; color: #333; padding: 5px; }

        .mobile-menu { display: none; background-color: #f8f9fa; border-top: 1px solid #e5e7eb; padding: 10px 0; }
        .mobile-menu.open { display: block; }
        .mobile-link { display: flex; align-items: center; padding: 15px 20px; font-size: 16px; font-weight: 500; color: #4b5563; border-bottom: 1px solid #eee; transition: background 0.2s; }
        .mobile-link:hover { background-color: #e5e7eb; }
        .mobile-link.active { color: #2563eb; background-color: #eff6ff; font-weight: 700; }
        .mobile-icon { margin-right: 12px; width: 20px; height: 20px; fill: currentColor; }

        @media (max-width: 1000px) {
            .nav-container { display: none; }
            .hamburger-btn { display: block; }
            .header-container { padding: 0 1rem; }
            .dashboard-layout { flex-direction: column !important; }
            .right-panel { height: auto !important; position: static !important; }
        }

        /* ë©”ì¸ ì»¨í…Œì´ë„ˆ */
        .container { max-width: 1600px; margin: 0 auto; padding: 30px 20px; min-height: calc(100vh - 200px); }
        .page-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; }
        .page-title { font-size: 24px; font-weight: 800; color: #2c3e50; margin: 0; border-bottom: 3px solid #3498db; padding-bottom: 5px; display: inline-block; }

        #loginSection { max-width: 400px; margin: 100px auto; text-align: center; background: #fff; padding: 40px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .btn-google { background-color: #fff; color: #444; border: 1px solid #ddd; display: flex; align-items: center; justify-content: center; gap: 12px; padding: 15px; font-size: 16px; width: 100%; cursor: pointer; border-radius: 6px; margin-top: 20px; transition: background 0.2s; }
        .btn-google:hover { background-color: #f8f9fa; }

        /* ëŒ€ì‹œë³´ë“œ ë ˆì´ì•„ì›ƒ */
        .dashboard-layout { display: flex; gap: 30px; align-items: flex-start; }
        .left-panel { flex: 1.4; display: flex; flex-direction: column; gap: 20px; }
        .right-panel { flex: 0.6; display: flex; flex-direction: column; gap: 20px; height: calc(100vh - 120px); overflow-y: auto; position: sticky; top: 84px; padding-right: 10px; }

        /* í•„í„° ì¹´ë“œ */
        .big-filter-card { background-color: #e3f2fd; border: 2px solid #2196f3; border-radius: 12px; padding: 20px; box-shadow: 0 4px 10px rgba(33, 150, 243, 0.2); }
        .filter-header { font-size: 16px; font-weight: bold; color: #1565c0; margin-bottom: 10px; }
        .filter-row { display: flex; gap: 10px; flex-wrap: wrap; }
        .filter-row select, .filter-row input { flex: 1; min-width: 100px; padding: 12px; font-size: 16px; border: 1px solid #90caf9; border-radius: 8px; background: white; font-weight: bold; cursor: pointer; }

        /* ì…ë ¥ ì¹´ë“œ */
        .input-card { background: #fff; padding: 25px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); border-top: 5px solid #8e44ad; }
        .section-title { font-size: 18px; font-weight: bold; margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center; color: #333; }

        /* íƒ­ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .tab-container { display: flex; gap: 10px; margin-bottom: 20px; border-bottom: 2px solid #eee; padding-bottom: 10px; }
        .tab-btn { padding: 10px 20px; border: none; background: #f1f3f5; border-radius: 6px; font-weight: bold; color: #868e96; cursor: pointer; font-size: 16px; transition: 0.2s; }
        .tab-btn.active { background: #8e44ad; color: white; }
        .tab-btn:hover:not(.active) { background: #e9ecef; }

        /* OMR ìŠ¤íƒ€ì¼ ê°ê´€ì‹ ì…ë ¥ */
        .mc-row { display: flex; align-items: flex-start; padding: 12px 0; border-bottom: 1px solid #f0f0f0; gap: 15px; }
        .q-num { width: 40px; font-weight: bold; color: #555; padding-top: 8px; text-align: center; }
        .omr-group { display: flex; gap: 8px; align-items: center; padding-top: 5px; }
        .omr-radio { display: none; }
        .omr-label { width: 32px; height: 32px; border-radius: 50%; border: 2px solid #ddd; display: flex; align-items: center; justify-content: center; font-weight: bold; color: #999; cursor: pointer; transition: 0.2s; font-size: 14px; }
        .omr-radio:checked + .omr-label { background-color: #2563eb; border-color: #2563eb; color: white; }
        
        /* í•´ì„¤ ì…ë ¥ */
        .exp-input { flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px; min-height: 40px; resize: vertical; }

        /* ì„œìˆ í˜• ì…ë ¥ */
        .essay-row { display: flex; gap: 10px; margin-bottom: 15px; align-items: flex-start; background: #f9f9f9; padding: 15px; border-radius: 8px; }
        .essay-num { width: 80px; padding: 10px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-weight: bold; }
        .essay-ans { flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px; min-height: 60px; }

        /* ë²„íŠ¼ */
        .btn-save { background-color: #2ecc71; color: white; padding: 15px; width: 100%; border: none; border-radius: 6px; font-size: 18px; font-weight: bold; cursor: pointer; margin-top: 20px; }
        .btn-cancel { background-color: #95a5a6; color: white; padding: 12px; width: 100%; border: none; border-radius: 6px; font-weight: bold; cursor: pointer; margin-top: 10px; display: none; }

        /* ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */
        .exam-item { background: #fff; padding: 20px; border-radius: 12px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); border-left: 5px solid #e67e22; margin-bottom: 15px; cursor: pointer; transition: 0.2s; }
        .exam-item:hover { transform: translateX(5px); }
        .exam-info h4 { margin: 0 0 5px 0; color: #333; }
        .exam-meta { font-size: 13px; color: #777; }

        .hidden { display: none !important; }
        .main-footer { text-align: center; padding: 40px 0; color: #999; font-size: 14px; border-top: 1px solid #eee; margin-top: 40px; }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;600;700;800&display=swap" rel="stylesheet">
</head>
<body>

    <div id="loginSection">
        <h2>ğŸ” ì„ ìƒë‹˜ ë¡œê·¸ì¸</h2>
        <p>ì‹œí—˜ ì •ë‹µ ê´€ë¦¬ í˜ì´ì§€ì…ë‹ˆë‹¤.<br>ì„ ìƒë‹˜ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.</p>
        <button class="btn-google" onclick="loginWithGoogle()">
            <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="G" width="20">
            Google ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸
        </button>
    </div>

    <div id="dashboardSection" class="hidden">
        
        <header>
            <div class="header-container">
                <div class="logo-text" onclick="location.href='https://westory28.github.io/Bang-westory/teacher-test.html'">
                    <span class="logo-we">We</span><span class="logo-story">story</span>
                </div>
        
                <nav class="nav-container">
                    <a href="https://westory28.github.io/Bang-westory/teacher_quiz-admin.html" class="nav-link">ì—­ì‚¬ í€´ì¦ˆ ëŒ€ì‹œë³´ë“œ</a>
                    <a href="https://westory28.github.io/Bang-westory/teacher_student-list-admin.html" class="nav-link">í•™ìƒ ê´€ë¦¬</a>
                    <a href="https://westory28.github.io/Bang-westory/teacher_yourscore-admin.html" class="nav-link">ì„±ì  ì‚°ì¶œ ê´€ë¦¬</a>
                    <a href="#" class="nav-link active">ì‹œí—˜ ì •ë‹µ ê´€ë¦¬</a>
                </nav>
        
                <div class="right-actions">
                    <button onclick="logout()" class="btn-logout-custom">ë¡œê·¸ì•„ì›ƒ</button>
                    <button class="hamburger-btn" onclick="toggleMobileMenu()">â˜°</button>
                </div>
            </div>
            
            <div id="mobileMenu" class="mobile-menu">
                <a href="#" class="mobile-link active">ì‹œí—˜ ì •ë‹µ ê´€ë¦¬</a>
                </div>
        </header>

        <div class="container">
            <div class="page-header">
                <h1 class="page-title">ğŸ’¯ ì‹œí—˜ ì •ë‹µ ë° í•´ì„¤ ê´€ë¦¬</h1>
            </div>

            <div class="dashboard-layout">
                
                <div class="left-panel">
                    <div class="big-filter-card">
                        <div class="filter-header">ğŸ“Œ ì‹œí—˜ ì •ë³´ ì„¤ì •</div>
                        <div class="filter-row">
                            <select id="yearInput">
                                <option value="2025">2025í•™ë…„ë„</option>
                                <option value="2026">2026í•™ë…„ë„</option>
                            </select>
                            <select id="semesterInput">
                                <option value="1í•™ê¸°_ì¤‘ê°„">1í•™ê¸° ì¤‘ê°„</option>
                                <option value="1í•™ê¸°_ê¸°ë§">1í•™ê¸° ê¸°ë§</option>
                                <option value="2í•™ê¸°_ì¤‘ê°„">2í•™ê¸° ì¤‘ê°„</option>
                                <option value="2í•™ê¸°_ê¸°ë§">2í•™ê¸° ê¸°ë§</option>
                            </select>
                            <select id="gradeInput">
                                <option value="2í•™ë…„">2í•™ë…„</option>
                                <option value="3í•™ë…„">3í•™ë…„</option>
                                <option value="1í•™ë…„">1í•™ë…„</option>
                            </select>
                            <input type="text" id="subjectInput" placeholder="ê³¼ëª©ëª… (ì˜ˆ: ì—­ì‚¬)" value="ì—­ì‚¬">
                        </div>
                    </div>

                    <div class="input-card">
                        <div class="section-title">
                            <span id="formTitle">âœï¸ ì •ë‹µ ì…ë ¥</span>
                        </div>

                        <div class="tab-container">
                            <button class="tab-btn active" onclick="switchTab('mc')">ê°ê´€ì‹ (ì„ íƒí˜•)</button>
                            <button class="tab-btn" onclick="switchTab('essay')">ì„œìˆ í˜• (ë…¼ìˆ í˜•)</button>
                        </div>

                        <div id="mcSection">
                            <div style="background:#fff3cd; padding:10px; border-radius:6px; font-size:14px; margin-bottom:15px; color:#856404;">
                                â€» 5ì§€ì„ ë‹¤í˜• ì •ë‹µì„ í´ë¦­í•˜ê³ , í•„ìš”í•œ ê²½ìš° í•´ì„¤ì„ ì…ë ¥í•˜ì„¸ìš”.
                            </div>
                            <div id="mcList"></div> </div>

                        <div id="essaySection" class="hidden">
                            <div style="background:#d1ecf1; padding:10px; border-radius:6px; font-size:14px; margin-bottom:15px; color:#0c5460;">
                                â€» ì„¸íŠ¸ ë¬¸í•­(ì˜ˆ: 1-1, 1-2)ì€ ë¬¸í•­ ë²ˆí˜¸ë¥¼ ì§ì ‘ ì…ë ¥í•˜ì„¸ìš”.<br>
                                â€» ì„œìˆ í˜•ì€ ìë™ ì±„ì ë˜ì§€ ì•Šê³  í•™ìƒì—ê²Œ ì •ë‹µ ì˜ˆì‹œë§Œ ë³´ì—¬ì§‘ë‹ˆë‹¤.
                            </div>
                            <div id="essayList"></div>
                            <button class="btn-add" style="background:#8e44ad; color:white; width:100%; padding:10px; border:none; border-radius:6px; cursor:pointer;" onclick="addEssayRow()">+ ì„œìˆ í˜• ë¬¸í•­ ì¶”ê°€</button>
                        </div>

                        <button id="saveBtn" class="btn-save" onclick="saveExamData()">ğŸ’¾ ì •ë‹µ ë° í•´ì„¤ ì €ì¥</button>
                        <button id="cancelBtn" class="btn-cancel" onclick="resetForm()">ì·¨ì†Œ (ì´ˆê¸°í™”)</button>
                    </div>
                </div>

                <div class="right-panel">
                    <div class="input-card" style="border-top-color: #e67e22; height:100%;">
                        <div class="section-title">ğŸ“‚ ë“±ë¡ëœ ì‹œí—˜ ëª©ë¡</div>
                        <div id="savedExamList">
                            </div>
                    </div>
                </div>

            </div>
        </div>

        <footer class="main-footer">
            Copyright Â© ì—­ì‚¬êµì‚¬ ë°©ì¬ì„. All rights reserved.
        </footer>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import { getFirestore, collection, addDoc, getDocs, orderBy, query, doc, updateDoc, deleteDoc, where } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js";

        const firebaseConfig = {
          apiKey: "AIzaSyAOlPQ5PFmL0zxmGrGcuEBnqBXisph7kPU",
          authDomain: "history-quiz-yongsin.firebaseapp.com",
          projectId: "history-quiz-yongsin",
          storageBucket: "history-quiz-yongsin.firebasestorage.app",
          messagingSenderId: "177587430482",
          appId: "1:177587430482:web:1188e0f661368040c3ab8b",
          measurementId: "G-YG2SLS45D8"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);

        let editingDocId = null;
        let allExams = [];

        // ì „ì—­ í•¨ìˆ˜ ì—°ê²°
        window.loginWithGoogle = async () => { try { await signInWithPopup(auth, new GoogleAuthProvider()); } catch (e) { console.error(e); alert("ë¡œê·¸ì¸ ì˜¤ë¥˜"); } };
        window.logout = async () => { if(confirm("ë¡œê·¸ì•„ì›ƒ?")) { await signOut(auth); location.reload(); } };
        window.toggleMobileMenu = () => { document.getElementById('mobileMenu').classList.toggle('open'); };
        
        window.switchTab = (tabName) => {
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            if(tabName === 'mc') {
                document.querySelector('.tab-btn:nth-child(1)').classList.add('active');
                document.getElementById('mcSection').classList.remove('hidden');
                document.getElementById('essaySection').classList.add('hidden');
            } else {
                document.querySelector('.tab-btn:nth-child(2)').classList.add('active');
                document.getElementById('mcSection').classList.add('hidden');
                document.getElementById('essaySection').classList.remove('hidden');
            }
        };

        onAuthStateChanged(auth, (user) => {
            if (user && user.email === "westoria28@gmail.com") {
                document.getElementById('loginSection').classList.add('hidden');
                document.getElementById('dashboardSection').classList.remove('hidden');
                initMCForm();
                addEssayRow(); // ê¸°ë³¸ 1ê°œ
                loadExamList();
            } else if (user) {
                alert("ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤."); signOut(auth);
            }
        });

        // ê°ê´€ì‹ í¼ 30ê°œ ìƒì„±
        function initMCForm() {
            const list = document.getElementById('mcList');
            list.innerHTML = '';
            for(let i=1; i<=30; i++) {
                const row = document.createElement('div');
                row.className = 'mc-row';
                row.innerHTML = `
                    <div class="q-num">${i}ë²ˆ</div>
                    <div class="omr-group">
                        ${[1,2,3,4,5].map(num => `
                            <input type="radio" name="q${i}" id="q${i}_${num}" value="${num}" class="omr-radio">
                            <label for="q${i}_${num}" class="omr-label">${num}</label>
                        `).join('')}
                    </div>
                    <textarea class="exp-input" id="exp${i}" placeholder="${i}ë²ˆ í•´ì„¤ ì…ë ¥ (ì„ íƒ)"></textarea>
                `;
                list.appendChild(row);
            }
        }

        // ì„œìˆ í˜• í–‰ ì¶”ê°€
        window.addEssayRow = (data = null) => {
            const list = document.getElementById('essayList');
            const div = document.createElement('div');
            div.className = 'essay-row';
            
            const numVal = data ? data.label : '';
            const ansVal = data ? data.answer : '';

            div.innerHTML = `
                <input type="text" class="essay-num" placeholder="ë²ˆí˜¸(1-1)" value="${numVal}">
                <textarea class="essay-ans" placeholder="ì„œìˆ í˜• ì •ë‹µ ë° ì±„ì  ê¸°ì¤€ ì…ë ¥">${ansVal}</textarea>
                <button onclick="this.parentElement.remove()" style="background:#e74c3c; color:white; border:none; border-radius:4px; cursor:pointer; width:30px;">x</button>
            `;
            list.appendChild(div);
        };

        // ë°ì´í„° ì €ì¥
        window.saveExamData = async () => {
            const year = document.getElementById('yearInput').value;
            const semester = document.getElementById('semesterInput').value;
            const grade = document.getElementById('gradeInput').value;
            const subject = document.getElementById('subjectInput').value;

            // ê°ê´€ì‹ ë°ì´í„° ìˆ˜ì§‘
            const mcData = [];
            for(let i=1; i<=30; i++) {
                const selected = document.querySelector(`input[name="q${i}"]:checked`);
                const exp = document.getElementById(`exp${i}`).value;
                if(selected || exp) {
                    mcData.push({
                        qNum: i,
                        answer: selected ? parseInt(selected.value) : null,
                        explanation: exp
                    });
                }
            }

            // ì„œìˆ í˜• ë°ì´í„° ìˆ˜ì§‘
            const essayData = [];
            document.querySelectorAll('.essay-row').forEach(row => {
                const label = row.querySelector('.essay-num').value.trim();
                const answer = row.querySelector('.essay-ans').value.trim();
                if(label && answer) {
                    essayData.push({ label, answer });
                }
            });

            if(mcData.length === 0 && essayData.length === 0) {
                alert("ì…ë ¥ëœ ì •ë‹µì´ ì—†ìŠµë‹ˆë‹¤."); return;
            }

            const saveData = {
                year, semester, grade, subject,
                mcQuestions: mcData,
                essayQuestions: essayData,
                updatedAt: new Date()
            };

            try {
                if(editingDocId) {
                    await updateDoc(doc(db, "exam_answers", editingDocId), saveData);
                    alert("ìˆ˜ì • ì™„ë£Œ!");
                } else {
                    saveData.createdAt = new Date();
                    await addDoc(collection(db, "exam_answers"), saveData);
                    alert("ì €ì¥ ì™„ë£Œ!");
                }
                resetForm();
                loadExamList();
            } catch(e) {
                console.error(e); alert("ì €ì¥ ì‹¤íŒ¨");
            }
        };

        // ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸°
        async function loadExamList() {
            const listDiv = document.getElementById('savedExamList');
            listDiv.innerHTML = 'ë¡œë”© ì¤‘...';
            
            const q = query(collection(db, "exam_answers"), orderBy("updatedAt", "desc"));
            const snapshot = await getDocs(q);
            
            allExams = [];
            listDiv.innerHTML = '';
            
            snapshot.forEach(doc => {
                const d = doc.data();
                const div = document.createElement('div');
                div.className = 'exam-item';
                div.innerHTML = `
                    <div class="exam-info">
                        <h4>${d.year} ${d.semester.replace('_',' ')} [${d.grade}] ${d.subject}</h4>
                        <div class="exam-meta">ê°ê´€ì‹ ${d.mcQuestions ? d.mcQuestions.length : 0}ë¬¸í•­ / ì„œìˆ í˜• ${d.essayQuestions ? d.essayQuestions.length : 0}ë¬¸í•­</div>
                    </div>
                    <div style="margin-top:10px; text-align:right;">
                        <button onclick="editExam('${doc.id}')" style="background:#f39c12; color:white; border:none; padding:5px 10px; border-radius:4px; cursor:pointer;">ìˆ˜ì •</button>
                        <button onclick="deleteExam('${doc.id}')" style="background:#e74c3c; color:white; border:none; padding:5px 10px; border-radius:4px; cursor:pointer;">ì‚­ì œ</button>
                    </div>
                `;
                listDiv.appendChild(div);
                allExams.push({ id: doc.id, ...d });
            });
        }

        // ìˆ˜ì • ëª¨ë“œ ì§„ì…
        window.editExam = (id) => {
            const data = allExams.find(e => e.id === id);
            if(!data) return;
            
            editingDocId = id;
            document.getElementById('yearInput').value = data.year;
            document.getElementById('semesterInput').value = data.semester;
            document.getElementById('gradeInput').value = data.grade;
            document.getElementById('subjectInput').value = data.subject;

            // ê°ê´€ì‹ ë³µì›
            initMCForm(); // ì´ˆê¸°í™”
            if(data.mcQuestions) {
                data.mcQuestions.forEach(q => {
                    const radio = document.getElementById(`q${q.qNum}_${q.answer}`);
                    if(radio) radio.checked = true;
                    const exp = document.getElementById(`exp${q.qNum}`);
                    if(exp) exp.value = q.explanation || '';
                });
            }

            // ì„œìˆ í˜• ë³µì›
            document.getElementById('essayList').innerHTML = '';
            if(data.essayQuestions && data.essayQuestions.length > 0) {
                data.essayQuestions.forEach(item => addEssayRow(item));
            } else {
                addEssayRow();
            }

            document.getElementById('saveBtn').innerText = "ğŸ”„ ìˆ˜ì •ì‚¬í•­ ì €ì¥";
            document.getElementById('cancelBtn').style.display = 'block';
            document.getElementById('formTitle').innerText = "ğŸ“ ì‹œí—˜ ì •ë³´ ìˆ˜ì • ì¤‘";
            window.scrollTo({ top: 0, behavior: 'smooth' });
        };

        window.deleteExam = async (id) => {
            if(confirm("ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
                await deleteDoc(doc(db, "exam_answers", id));
                loadExamList();
                if(editingDocId === id) resetForm();
            }
        };

        window.resetForm = () => {
            editingDocId = null;
            document.getElementById('subjectInput').value = 'ì—­ì‚¬';
            initMCForm();
            document.getElementById('essayList').innerHTML = '';
            addEssayRow();
            document.getElementById('saveBtn').innerText = "ğŸ’¾ ì •ë‹µ ë° í•´ì„¤ ì €ì¥";
            document.getElementById('cancelBtn').style.display = 'none';
            document.getElementById('formTitle').innerText = "âœï¸ ì •ë‹µ ì…ë ¥";
        };
    </script>
</body>
</html>
