<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìš©ì‹ ì¤‘í•™êµ ì—­ì‚¬ í‰ê°€</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&family=Noto+Serif+KR:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; background-color: #f5f5f4; }
        .serif { font-family: 'Noto Serif KR', serif; }
        .fade-in { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        .timer-bar { transition: width 1s linear; }
        .timer-urgent { background-color: #ef4444 !important; animation: pulse 1s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .choice-btn { width: 100%; text-align: left; padding: 1rem; border-radius: 0.5rem; border: 1px solid #e5e7eb; background-color: white; transition: all 0.2s; display: flex; align-items: center; cursor: pointer; }
        .choice-btn:hover { background-color: #f5f5f4; }
        .choice-btn.selected { border: 2px solid #d97706; background-color: #fffbeb; color: #92400e; font-weight: bold; }
        .choice-badge { width: 1.5rem; height: 1.5rem; border-radius: 9999px; background-color: #e5e7eb; display: inline-flex; align-items: center; justify-content: center; font-size: 0.75rem; font-weight: bold; margin-right: 0.75rem; }
        .choice-btn.selected .choice-badge { background-color: #d97706; color: white; }
        .ox-btn { height: 80px; font-size: 2.5rem; font-weight: 900; border-radius: 12px; transition: all 0.2s; border: 2px solid transparent; width: 100%; cursor: pointer;}
        .ox-btn:hover { transform: translateY(-2px); box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .btn-o { background-color: #e0f2fe; color: #0284c7; border-color: #0284c7; }
        .btn-o.selected { background-color: #0284c7; color: white; border: 2px solid #0c4a6e;}
        .btn-x { background-color: #fee2e2; color: #dc2626; border-color: #dc2626; }
        .btn-x.selected { background-color: #dc2626; color: white; border: 2px solid #7f1d1d;}
        .seq-btn { padding: 8px 12px; border-radius: 6px; font-weight: bold; border: 1px solid #d1d5db; transition: all 0.2s; cursor: pointer; margin: 4px; }
        .seq-btn-default { background-color: #ffffff !important; color: #1f2937 !important; }
        .seq-btn-selected { background-color: #d97706 !important; color: #ffffff !important; border-color: #b45309 !important; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        #loading-overlay { display: none; position: fixed; inset: 0; background: rgba(255,255,255,0.9); z-index: 9999; justify-content: center; align-items: center; flex-direction: column; }
        .q-image-thumb { max-width: 100%; max-height: 250px; border-radius: 8px; margin: 10px auto; border: 1px solid #e5e7eb; display: block; object-fit: contain; cursor: zoom-in; transition: transform 0.2s; }
        #image-zoom-modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 10000; justify-content: center; align-items: center; cursor: zoom-out; }
        #image-zoom-content { max-width: 95%; max-height: 95%; border-radius: 4px; }
    </style>
</head>
<body class="text-stone-800 min-h-screen flex flex-col">
    <div id="loading-overlay"><div class="animate-spin rounded-full h-16 w-16 border-t-4 border-amber-600 border-solid mb-4"></div><p class="text-xl font-bold text-stone-700">ë¡œë”© ì¤‘...</p></div>
    <div id="image-zoom-modal" onclick="document.getElementById('image-zoom-modal').style.display='none'"><img id="image-zoom-content" src=""></div>

    <header class="bg-stone-900 text-white py-4 shadow-lg sticky top-0 z-40">
        <div class="container mx-auto px-4"><h1 class="text-lg md:text-xl font-bold tracking-tight truncate"><span class="mr-2">ğŸ§‘â€ğŸ«</span> ìš©ì‹ ì¤‘í•™êµ ì—­ì‚¬êµì‚¬ ë°©ì¬ì„</h1></div>
    </header>

    <main class="flex-grow container mx-auto px-4 py-6">
        <section id="view-login" class="max-w-md mx-auto bg-white p-8 rounded-xl shadow-lg fade-in mt-8 border-t-4 border-amber-500">
            <div class="text-center mb-8">
                <span class="bg-amber-100 text-amber-900 text-sm font-bold px-3 py-1 rounded-full">ìš©ì‹ ì¤‘í•™êµ 2í•™ë…„ 2í•™ê¸° ì—­ì‚¬1</span>
                <h2 class="text-2xl font-bold serif text-stone-900 mt-4">ë‹¹ì‹ ì˜ ì—­ì‚¬ ì‹¤ë ¥ì€?</h2>
                <p class="text-red-500 font-bold text-sm mt-2"><i class="fas fa-stopwatch mr-1"></i> ì œí•œì‹œê°„ 60ì´ˆ (5ë¬¸ì œ)</p>
            </div>
            <div class="space-y-4">
                <div class="flex gap-2">
                    <div class="w-1/4 bg-stone-100 border border-stone-300 rounded flex items-center justify-center font-bold text-stone-600">2í•™ë…„</div>
                    <select id="input-class" class="w-2/4 p-3 border border-stone-300 rounded"><option value="">ë°˜</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select>
                    <input type="number" id="input-number" placeholder="ë²ˆí˜¸" class="w-1/4 p-3 border border-stone-300 rounded text-center">
                </div>
                <input type="text" id="input-name" placeholder="ì´ë¦„" class="w-full p-3 border border-stone-300 rounded">
                <button onclick="app.startQuiz()" class="w-full bg-stone-900 text-white font-bold py-4 rounded-lg hover:bg-stone-700 transition shadow-lg mt-4">ë„ì „ ì‹œì‘ <i class="fas fa-play ml-2"></i></button>
            </div>
        </section>

        <section id="view-quiz" class="hidden max-w-2xl mx-auto fade-in">
            <div class="bg-white rounded-lg shadow-sm mb-6 sticky top-20 z-30 overflow-hidden border border-stone-200">
                <div class="flex justify-between items-center px-4 py-2 bg-stone-50 border-b border-stone-100">
                    <span class="text-sm font-bold text-stone-600" id="quiz-progress-text">1 / 5</span>
                    <span class="text-lg font-bold text-red-600 font-mono" id="timer-text">60ì´ˆ</span>
                </div>
                <div class="w-full bg-stone-200 h-2"><div id="timer-bar" class="bg-amber-500 h-full timer-bar" style="width: 100%"></div></div>
            </div>
            <div class="bg-white p-6 md:p-10 rounded-lg min-h-[400px] flex flex-col relative shadow-md">
                <div class="mb-4"><span id="student-question-unit" class="inline-block bg-stone-100 text-stone-500 text-xs font-bold px-2 py-1 rounded mb-1 border border-stone-200"></span><span id="question-badge" class="ml-2 bg-amber-100 text-amber-800 text-xs font-bold px-2 py-1 rounded border border-amber-200"></span></div>
                <div id="question-image-area" class="mb-4 hidden text-center"><img id="question-image" src="" class="q-image-thumb" onclick="document.getElementById('image-zoom-content').src=this.src;document.getElementById('image-zoom-modal').style.display='flex'"></div>
                <h3 id="question-text" class="text-xl md:text-2xl font-bold mt-2 mb-8 text-stone-900 leading-relaxed serif break-keep"></h3>
                <div id="answer-area" class="flex-grow mb-6"></div>
                <div class="flex gap-3 mt-auto">
                    <button id="btn-prev" onclick="app.prevQuestion()" class="hidden w-1/3 bg-stone-200 text-stone-700 font-bold py-4 rounded-lg hover:bg-stone-300">ì´ì „</button>
                    <button id="btn-next" onclick="app.submitAnswer()" class="w-full bg-amber-600 text-white font-bold py-4 rounded-lg hover:bg-amber-700 shadow-md">ë‹¤ìŒ</button>
                </div>
            </div>
        </section>

        <section id="view-results" class="hidden max-w-lg mx-auto fade-in mt-6">
            <div class="bg-white p-8 rounded-xl shadow-xl text-center border-t-8 border-amber-500">
                <h2 class="text-3xl font-bold serif mb-2 text-stone-800">í‰ê°€ ì¢…ë£Œ</h2>
                <p class="text-stone-500 mb-6"><span id="result-name" class="font-bold text-stone-900"></span> í•™ìƒì˜ ìµœì¢… ê¸°ë¡</p>
                <div class="relative w-48 h-48 mx-auto mb-4"><canvas id="scoreChart"></canvas><div class="absolute inset-0 flex items-center justify-center flex-col"><span class="text-5xl font-bold text-amber-600 font-mono" id="score-text">0</span><span class="text-xs text-stone-400">ì </span></div></div>
                <div id="submission-status" class="bg-stone-50 p-3 rounded text-sm mb-6 border border-stone-200 text-stone-500"><i class="fas fa-circle-notch fa-spin"></i> ë°ì´í„° ì €ì¥ ì¤‘...</div>
                <div class="grid grid-cols-2 gap-3">
                    <button onclick="document.getElementById('review-section').classList.toggle('hidden')" class="bg-white border-2 border-stone-200 text-stone-700 font-bold py-3 rounded hover:bg-stone-50">ì˜¤ë‹µë…¸íŠ¸</button>
                    <button onclick="location.reload()" class="bg-stone-900 text-white font-bold py-3 rounded hover:bg-stone-700 shadow-lg">ë‹¤ì‹œ ë„ì „</button>
                </div>
            </div>
            <div id="review-section" class="hidden mt-6 bg-white p-6 rounded-xl shadow-lg border border-red-200">
                <h3 class="font-bold text-lg mb-4 text-red-600 border-b pb-2">ì˜¤ë‹µ í™•ì¸</h3>
                <div id="review-list" class="space-y-4 text-left"></div>
            </div>
        </section>
    </main>
    <footer class="bg-stone-100 py-6 mt-8 border-t border-stone-200 text-center"><p class="text-stone-400 text-xs font-bold font-mono">Copyright Â© ìš©ì‹ ì¤‘í•™êµ ì—­ì‚¬êµì‚¬ ë°©ì¬ì„.</p></footer>

    <script>
        const firebaseConfig = { apiKey: "AIzaSyAOlPQ5PFmL0zxmGrGcuEBnqBXisph7kPU", authDomain: "history-quiz-yongsin.firebaseapp.com", projectId: "history-quiz-yongsin", storageBucket: "history-quiz-yongsin.firebasestorage.app", messagingSenderId: "177587430482", appId: "1:177587430482:web:d79cc145c11e335cc3ab8b", measurementId: "G-LHN97D7R2R" };
        let db; try { if (!firebase.apps.length) { firebase.initializeApp(firebaseConfig); } db = firebase.firestore(); } catch(e) { alert("Firebase ì˜¤ë¥˜"); }

        const app = {
            state: { student:{}, questions:[], allQuestions:[], currentIndex:0, answers:{}, score:0, timer:null, timeLeft:60, isTimeOut:false, isQuizActive: false },
            init: function() { this.loadQuestionsFromFirebase(); },
            showLoading: function(show) { document.getElementById('loading-overlay').style.display = show ? 'flex' : 'none'; },
            loadQuestionsFromFirebase: function() {
                if(!db) return;
                this.showLoading(true);
                db.collection("quiz_questions").get().then((querySnapshot) => {
                    const loadedData = [];
                    querySnapshot.forEach((doc) => { let data = doc.data(); data.id = parseInt(doc.id); loadedData.push(data); });
                    loadedData.sort((a, b) => a.id - b.id);
                    this.state.allQuestions = loadedData;
                    this.showLoading(false);
                }).catch((error) => { this.showLoading(false); this.state.allQuestions = []; });
            },
            startQuiz: async function() {
                const cls = document.getElementById('input-class').value;
                const num = document.getElementById('input-number').value;
                const name = document.getElementById('input-name').value.trim();
                if(!cls || !num || !name) { alert("ì •ë³´ë¥¼ ëª¨ë‘ ì…ë ¥í•˜ì„¸ìš”."); return; }
                this.showLoading(true);
                try {
                    const logsRef = db.collection("quiz_results");
                    const snapshot = await logsRef.where("class", "==", cls).where("number", "==", num).where("name", "==", name).get();
                    let recentSubmission = null;
                    snapshot.forEach(doc => { const data = doc.data(); if (data.timestamp) { const date = data.timestamp.toDate(); if (!recentSubmission || date > recentSubmission) recentSubmission = date; } });
                    if (recentSubmission) { const diffMins = (new Date() - recentSubmission) / (1000 * 60); if (diffMins < 10) { this.showLoading(false); alert(`ì´ë¯¸ ì œì¶œí•˜ì…¨ìŠµë‹ˆë‹¤. ${Math.ceil(10 - diffMins)}ë¶„ ë’¤ì— ì‹œë„í•˜ì„¸ìš”.`); return; } }
                } catch(e) {}
                this.showLoading(false);
                this.state.student = { class:cls, number:num, name:name };
                if(this.state.allQuestions.length === 0) { alert("ë¬¸ì œ ì—†ìŒ"); return; }
                const unitGroups = {}; this.state.allQuestions.forEach(q => { const u = q.unit || "ê¸°íƒ€"; if(!unitGroups[u]) unitGroups[u] = []; unitGroups[u].push(q); });
                const targetUnits = ["I. ë¬¸ëª…ì˜ ë°œìƒê³¼ ê³ ëŒ€ ì„¸ê³„ì˜ í˜•ì„±", "II. ì„¸ê³„ ì¢…êµì˜ í™•ì‚°ê³¼ ì§€ì—­ ë¬¸í™”ì˜ í˜•ì„±", "III. ì§€ì—­ ì„¸ê³„ì˜ êµë¥˜ì™€ ë³€í™”", "IV. ì œêµ­ì£¼ì˜ ì¹¨ëµê³¼ êµ­ë¯¼ êµ­ê°€ ê±´ì„¤ ìš´ë™", "V. ì„¸ê³„ ëŒ€ì „ê³¼ ì‚¬íšŒ ë³€ë™"];
                const selectedQuestions = []; const usedIds = new Set();
                targetUnits.forEach(u => { if(unitGroups[u] && unitGroups[u].length > 0) { const q = unitGroups[u][Math.floor(Math.random() * unitGroups[u].length)]; selectedQuestions.push(q); usedIds.add(q.id); } });
                if (selectedQuestions.length < 5) { const remaining = this.state.allQuestions.filter(q => !usedIds.has(q.id)); const shuffled = this.shuffleArray(remaining); for(let i=0; i<5-selectedQuestions.length; i++) if(shuffled[i]) selectedQuestions.push(shuffled[i]); }
                this.state.questions = this.shuffleArray(selectedQuestions);
                this.state.currentIndex = 0; this.state.answers = {}; this.state.score = 0; this.state.timeLeft = 60; this.state.isTimeOut = false; this.state.isQuizActive = true; 
                this.showView('view-quiz'); this.renderQuestion(); this.startTimer();
            },
            shuffleArray: function(array) { for (let i = array.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [array[i], array[j]] = [array[j], array[i]]; } return array; },
            startTimer: function() { if(this.state.timer) clearInterval(this.state.timer); const bar = document.getElementById('timer-bar'), txt = document.getElementById('timer-text'); bar.style.width='100%'; txt.innerText='60ì´ˆ'; this.state.timer = setInterval(() => { this.state.timeLeft--; txt.innerText = this.state.timeLeft + 'ì´ˆ'; bar.style.width = (this.state.timeLeft/60)*100 + '%'; if(this.state.timeLeft<=10) { bar.classList.add('timer-urgent'); txt.classList.add('animate-pulse'); } if(this.state.timeLeft<=0) { clearInterval(this.state.timer); this.state.isTimeOut=true; alert("ì¢…ë£Œ"); this.finishQuiz(); } }, 1000); },
            renderQuestion: function() {
                const q = this.state.questions[this.state.currentIndex];
                this.tempAnswer = this.state.answers[q.id] || null;
                document.getElementById('quiz-progress-text').innerText = `${this.state.currentIndex+1}/5`;
                document.getElementById('question-badge').innerText = {'choice':'ê°ê´€ì‹','blank':'ë‹¨ë‹µ','word':'ë‹¨ë‹µ','order':'ìˆœì„œ','ox':'O/X'}[q.type];
                document.getElementById('student-question-unit').innerText = q.unit || "ê¸°íƒ€";
                const img = document.getElementById('question-image'); if(q.image) { img.src=q.image; img.parentNode.classList.remove('hidden'); } else img.parentNode.classList.add('hidden');
                document.getElementById('question-text').innerText = q.question;
                const area = document.getElementById('answer-area'); area.innerHTML = ''; 
                document.getElementById('btn-prev').classList.toggle('hidden', this.state.currentIndex === 0);
                document.getElementById('btn-next').className = this.state.currentIndex === 0 ? "w-full bg-amber-600 text-white font-bold py-4 rounded-lg hover:bg-amber-700 transition shadow-md" : "w-2/3 bg-amber-600 text-white font-bold py-4 rounded-lg hover:bg-amber-700 transition shadow-md";
                if(q.type === 'choice') { 
                    const grid = document.createElement('div'); grid.className="grid grid-cols-1 gap-3"; 
                    q.options.forEach((opt,i) => { const btn = document.createElement('div'); const isSelected = this.tempAnswer === opt; btn.className = `choice-btn ${isSelected ? 'selected' : ''}`; btn.innerHTML = `<span class="choice-badge">${i+1}</span> ${opt}`; btn.onclick = () => { this.state.answers[q.id] = opt; this.renderQuestion(); }; grid.appendChild(btn); }); area.appendChild(grid); 
                } else if(q.type === 'ox') { 
                    const box = document.createElement('div'); box.className="flex gap-4 h-40"; 
                    const btnO = document.createElement('button'); btnO.className=`flex-1 ox-btn btn-o ${this.tempAnswer==='O'?'selected':''}`; btnO.innerText="O"; btnO.onclick=()=>{ this.state.answers[q.id]='O'; this.renderQuestion(); }; 
                    const btnX = document.createElement('button'); btnX.className=`flex-1 ox-btn btn-x ${this.tempAnswer==='X'?'selected':''}`; btnX.innerText="X"; btnX.onclick=()=>{ this.state.answers[q.id]='X'; this.renderQuestion(); }; 
                    box.append(btnO,btnX); area.appendChild(box); 
                } else if(q.type === 'order') { 
                    this.orderTemp = this.tempAnswer ? this.tempAnswer.split('-') : []; 
                    const box = document.createElement('div'); box.className="border-2 dashed border-amber-300 rounded p-4 mb-3 bg-amber-50 min-h-[50px] flex flex-wrap gap-2"; 
                    const opts = document.createElement('div'); opts.className="flex flex-wrap gap-2"; 
                    this.orderTemp.forEach(opt => { const btn = document.createElement('button'); btn.className="seq-btn seq-btn-selected"; btn.innerText=opt; btn.onclick = () => { this.orderTemp = this.orderTemp.filter(x=>x!==opt); this.state.answers[q.id] = this.orderTemp.join('-'); this.renderQuestion(); }; box.appendChild(btn); }); 
                    q.options.filter(o => !this.orderTemp.includes(o)).forEach(opt => { const btn = document.createElement('button'); btn.className="seq-btn seq-btn-default"; btn.innerText=opt; btn.onclick = () => { this.orderTemp.push(opt); this.state.answers[q.id] = this.orderTemp.join('-'); this.renderQuestion(); }; opts.appendChild(btn); }); 
                    area.append(box, opts); 
                } else { 
                    const inp = document.createElement('input'); inp.type="text"; inp.className="w-full p-4 border-b-2 border-stone-300 focus:border-amber-500 text-center text-lg outline-none"; inp.placeholder="ì •ë‹µ ì…ë ¥"; 
                    if(this.tempAnswer) inp.value = this.tempAnswer; inp.oninput = (e) => { this.tempAnswer=e.target.value; this.state.answers[q.id] = e.target.value; }; inp.onkeydown = (e) => { if(e.key==='Enter') this.submitAnswer(); }; area.appendChild(inp); 
                }
            },
            prevQuestion: function() { const q = this.state.questions[this.state.currentIndex]; if (this.state.currentIndex > 0) { this.state.currentIndex--; this.renderQuestion(); } },
            submitAnswer: function() { const q = this.state.questions[this.state.currentIndex]; let ans = this.state.answers[q.id]; if(q.type==='order') { if(!ans || ans.split('-').length !== q.options.length) { alert("ìˆœì„œë¥¼ ì™„ì„±í•˜ì„¸ìš”"); return; } } else if(!ans) { alert("ì •ë‹µì„ ì…ë ¥í•˜ì„¸ìš”"); return; } if(this.state.currentIndex < 4) { this.state.currentIndex++; this.renderQuestion(); } else this.finishQuiz(); },
            finishQuiz: function() {
                clearInterval(this.state.timer); this.state.isQuizActive = false;
                let correct = 0; let details = []; let detailLogs = [];
                this.state.questions.forEach(q => {
                    const u = (this.state.answers[q.id]||"").toString().replace(/\s+/g,'').trim(); const a = q.answer.toString().replace(/\s+/g,'').trim();
                    let isC = (q.type === 'word' || q.type === 'blank') ? (u.includes(a)||a.includes(u)) : (u === a);
                    if(isC) correct++; else details.push({q:q.question, u:u||"ë¯¸ì…ë ¥", a:q.answer, exp:q.explanation});
                    detailLogs.push({ id: q.id, correct: isC, u: u });
                });
                this.state.score = correct * 20; this.state.incorrectDetails = details;
                this.showView('view-results'); this.renderResults(); this.saveToFirebase(detailLogs);
            },
            renderResults: function() { document.getElementById('result-name').innerText = this.state.student.name; document.getElementById('score-text').innerText = this.state.score; const ctx = document.getElementById('scoreChart').getContext('2d'); if(window.myChart) window.myChart.destroy(); window.myChart = new Chart(ctx, { type:'doughnut', data:{labels:['ì •ë‹µ','ì˜¤ë‹µ'], datasets:[{data:[this.state.score, 100-this.state.score], backgroundColor:['#d97706','#e5e7eb'], borderWidth:0}]}, options:{cutout:'80%', plugins:{legend:{display:false}}} }); const list = document.getElementById('review-list'); list.innerHTML = this.state.incorrectDetails.length===0 ? '<div class="text-center py-4">ë§Œì ì…ë‹ˆë‹¤! ğŸ‰</div>' : this.state.incorrectDetails.map(d => `<div class="border-b pb-3 last:border-0"><p class="font-bold text-stone-800 mb-1">Q. ${d.q}</p><div class="flex gap-2 text-xs mb-2"><span class="text-red-600 bg-red-50 px-2 py-1 rounded">ë‚´ ë‹µ: ${d.u}</span><span class="text-green-600 bg-green-50 px-2 py-1 rounded font-bold">ì •ë‹µ: ${d.a}</span></div><p class="text-xs text-stone-500 bg-stone-50 p-2 rounded">${d.exp}</p></div>`).join(''); },
            saveToFirebase: function(detailLogs = []) {
                const status = document.getElementById('submission-status');
                if(!db) { status.innerHTML = "âš ï¸ DB ì—°ê²° ì‹¤íŒ¨"; return; }
                const data = { timestamp: firebase.firestore.FieldValue.serverTimestamp(), timeString: new Date().toLocaleString(), class: this.state.student.class, number: this.state.student.number, name: this.state.student.name, score: this.state.score, status: this.state.isTimeOut ? "ì‹œê°„ì´ˆê³¼" : "ì™„ë£Œ", details: detailLogs };
                db.collection("quiz_results").add(data).then(() => { status.className = "bg-green-100 text-green-700 p-3 rounded text-sm mb-6 border border-green-200 font-bold"; status.innerHTML = '<i class="fas fa-check-circle"></i> ì œì¶œ ì™„ë£Œ!'; }).catch((error) => { console.error("Error: ", error); status.className = "bg-red-100 text-red-700 p-3 rounded text-sm mb-6 border border-red-200"; status.innerHTML = 'âš ï¸ ì „ì†¡ ì‹¤íŒ¨'; });
            },
            showView: function(id) { document.querySelectorAll('main > section').forEach(el => el.classList.add('hidden')); document.getElementById(id).classList.remove('hidden'); window.scrollTo(0,0); }
        };
        window.onload = function() { app.init(); };
    </script>
</body>
</html>
